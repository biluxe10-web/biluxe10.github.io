<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biluxe10 - Notifications</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        * { font-family: 'Inter', sans-serif; }
        .page-transition { animation: slideIn 0.5s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .notification-card { transition: all 0.3s ease; }
        .notification-card:hover { transform: translateX(5px); background: #f8fafc; }
        .notification-unread { border-left: 4px solid #3b82f6; background: #eff6ff; }
        .notification-read { border-left: 4px solid #d1d5db; }
        .type-earning { border-left-color: #10b981; }
        .type-withdrawal { border-left-color: #f59e0b; }
        .type-commission { border-left-color: #8b5cf6; }
        .type-system { border-left-color: #6b7280; }
        .type-package { border-left-color: #f97316; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation Sidebar (Same as dashboard) -->
    <div class="sidebar fixed left-0 top-0 h-full w-64 bg-gradient-to-b from-gray-900 to-black text-white shadow-xl z-50">
        <!-- Same sidebar code -->
    </div>

    <!-- Main Content -->
    <div class="ml-64 min-h-screen">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b border-gray-200">
            <div class="flex items-center justify-between h-16 px-8">
                <div>
                    <h2 class="text-xl font-semibold text-gray-900">Notifications</h2>
                    <p class="text-sm text-gray-600">Stay updated with your account activities</p>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="p-2 text-gray-600 hover:text-gray-900 relative">
                        <i class="fas fa-bell text-xl"></i>
                        <span id="notificationBadge" class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full hidden"></span>
                    </button>
                    <div class="flex items-center space-x-3 bg-gray-50 rounded-lg px-3 py-2 cursor-pointer" onclick="window.location.href='profile.html'">
                        <img id="headerProfilePic" src="https://via.placeholder.com/32" alt="Profile" class="w-8 h-8 rounded-full border-2 border-blue-500">
                        <span id="headerUserName" class="text-sm font-medium text-gray-900">User</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Notifications Content -->
        <main class="p-6 page-transition">
            <!-- Header Actions -->
            <div class="bg-white rounded-2xl shadow-sm p-6 mb-8 border border-gray-200">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900">All Notifications</h3>
                        <p class="text-sm text-gray-600 mt-1">Manage your notification preferences</p>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2 text-sm">
                            <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                            <span>Unread: <span id="unreadCount">0</span></span>
                        </div>
                        <div class="flex space-x-2">
                            <button id="markAllRead" class="px-4 py-2 bg-blue-600 text-white text-sm rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                                <i class="fas fa-check-double mr-2"></i>Mark All Read
                            </button>
                            <button id="clearAll" class="px-4 py-2 bg-gray-200 text-gray-700 text-sm rounded-lg font-semibold hover:bg-gray-300 transition-colors">
                                <i class="fas fa-trash mr-2"></i>Clear All
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Filter Tabs -->
                <div class="flex space-x-1 mt-6 overflow-x-auto">
                    <button id="filterAll" class="filter-tab px-4 py-2 text-sm font-medium rounded-lg bg-blue-600 text-white whitespace-nowrap">
                        All Notifications
                    </button>
                    <button id="filterUnread" class="filter-tab px-4 py-2 text-sm font-medium rounded-lg text-gray-600 hover:text-gray-900 hover:bg-gray-100 whitespace-nowrap">
                        Unread
                    </button>
                    <button id="filterEarnings" class="filter-tab px-4 py-2 text-sm font-medium rounded-lg text-gray-600 hover:text-gray-900 hover:bg-gray-100 whitespace-nowrap">
                        Earnings
                    </button>
                    <button id="filterWithdrawals" class="filter-tab px-4 py-2 text-sm font-medium rounded-lg text-gray-600 hover:text-gray-900 hover:bg-gray-100 whitespace-nowrap">
                        Withdrawals
                    </button>
                    <button id="filterSystem" class="filter-tab px-4 py-2 text-sm font-medium rounded-lg text-gray-600 hover:text-gray-900 hover:bg-gray-100 whitespace-nowrap">
                        System
                    </button>
                </div>
            </div>

            <!-- Notifications List -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-200">
                <div class="p-6">
                    <div id="notificationsList" class="space-y-4">
                        <div class="text-center py-12">
                            <div class="w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"></div>
                            <p class="text-gray-500 text-lg">Loading notifications...</p>
                        </div>
                    </div>

                    <!-- Load More Button -->
                    <div id="loadMoreContainer" class="hidden mt-6 text-center">
                        <button id="loadMoreBtn" class="px-6 py-3 bg-gray-100 text-gray-700 rounded-lg font-semibold hover:bg-gray-200 transition-colors">
                            <i class="fas fa-redo mr-2"></i>Load More Notifications
                        </button>
                    </div>

                    <!-- Empty State -->
                    <div id="emptyState" class="hidden text-center py-12">
                        <div class="text-6xl text-gray-300 mb-4">
                            <i class="fas fa-bell-slash"></i>
                        </div>
                        <p class="text-gray-500 text-lg">No notifications yet</p>
                        <p class="text-sm text-gray-400 mt-1">Your notifications will appear here</p>
                    </div>
                </div>
            </div>

            <!-- Notification Settings -->
            <div class="mt-8 bg-white rounded-2xl shadow-sm p-6 border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Notification Settings</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-medium text-gray-900">Earnings Notifications</p>
                                <p class="text-sm text-gray-600">Get notified about new commissions</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="earningNotifications" class="sr-only peer" checked>
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>

                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-medium text-gray-900">Withdrawal Updates</p>
                                <p class="text-sm text-gray-600">Status updates for withdrawal requests</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="withdrawalNotifications" class="sr-only peer" checked>
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>

                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-medium text-gray-900">Team Activity</p>
                                <p class="text-sm text-gray-600">When team members join or earn</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="teamNotifications" class="sr-only peer" checked>
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-medium text-gray-900">Package Updates</p>
                                <p class="text-sm text-gray-600">New package features and upgrades</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="packageNotifications" class="sr-only peer" checked>
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>

                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-medium text-gray-900">System Announcements</p>
                                <p class="text-sm text-gray-600">Important platform updates</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="systemNotifications" class="sr-only peer" checked>
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>

                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-medium text-gray-900">Email Notifications</p>
                                <p class="text-sm text-gray-600">Receive notifications via email</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="emailNotifications" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="mt-6 pt-6 border-t border-gray-200">
                    <button onclick="saveNotificationSettings()" class="px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                        <i class="fas fa-save mr-2"></i>Save Settings
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Firebase & Notifications Script -->
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDxxkC9iD1V1w-53Kf4oBrHEXlBLvCc7sE",
            authDomain: "biluxe10-3e894.firebaseapp.com",
            projectId: "biluxe10-3e894",
            storageBucket: "biluxe10-3e894.firebasestorage.app",
            messagingSenderId: "804749588233",
            appId: "1:804749588233:web:7777648c0c7834733c05d8"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        let currentUser = null;
        let notifications = [];
        let currentFilter = 'all';
        let lastVisible = null;
        const pageSize = 20;

        document.addEventListener('DOMContentLoaded', function() {
            checkAuthState();
            setupEventListeners();
        });

        function checkAuthState() {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    currentUser = user;
                    loadUserData(user.uid);
                    loadNotifications(user.uid);
                    loadNotificationSettings(user.uid);
                } else {
                    window.location.href = 'auth.html';
                }
            });
        }

        function loadUserData(userId) {
            db.collection('users').doc(userId).onSnapshot((doc) => {
                if (doc.exists) {
                    const userData = doc.data();
                    updateUserUI(userData);
                }
            });
        }

        function setupEventListeners() {
            // Filter tabs
            document.getElementById('filterAll').addEventListener('click', () => setFilter('all'));
            document.getElementById('filterUnread').addEventListener('click', () => setFilter('unread'));
            document.getElementById('filterEarnings').addEventListener('click', () => setFilter('earning'));
            document.getElementById('filterWithdrawals').addEventListener('click', () => setFilter('withdrawal'));
            document.getElementById('filterSystem').addEventListener('click', () => setFilter('system'));

            // Action buttons
            document.getElementById('markAllRead').addEventListener('click', markAllAsRead);
            document.getElementById('clearAll').addEventListener('click', clearAllNotifications);
            document.getElementById('loadMoreBtn').addEventListener('click', loadMoreNotifications);
        }

        function setFilter(filter) {
            currentFilter = filter;
            
            // Update active tab
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.classList.remove('bg-blue-600', 'text-white');
                tab.classList.add('text-gray-600', 'hover:text-gray-900', 'hover:bg-gray-100');
            });
            
            document.getElementById(`filter${filter.charAt(0).toUpperCase() + filter.slice(1)}`).classList.add('bg-blue-600', 'text-white');
            document.getElementById(`filter${filter.charAt(0).toUpperCase() + filter.slice(1)}`).classList.remove('text-gray-600', 'hover:text-gray-900', 'hover:bg-gray-100');
            
            updateNotificationsUI();
        }

        function loadNotifications(userId) {
            let query = db.collection('notifications')
                .where('userId', '==', userId)
                .orderBy('createdAt', 'desc')
                .limit(pageSize);

            query.onSnapshot((snapshot) => {
                notifications = [];
                snapshot.forEach((doc) => {
                    notifications.push({ id: doc.id, ...doc.data() });
                });
                
                // Get last visible document for pagination
                if (snapshot.docs.length > 0) {
                    lastVisible = snapshot.docs[snapshot.docs.length - 1];
                    document.getElementById('loadMoreContainer').classList.remove('hidden');
                } else {
                    document.getElementById('loadMoreContainer').classList.add('hidden');
                }
                
                updateNotificationsUI();
                updateUnreadCount();
            }, (error) => {
                console.error('Error loading notifications:', error);
            });
        }

        async function loadMoreNotifications() {
            if (!lastVisible) return;

            const loadMoreBtn = document.getElementById('loadMoreBtn');
            loadMoreBtn.disabled = true;
            loadMoreBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Loading...';

            try {
                const nextQuery = db.collection('notifications')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .startAfter(lastVisible)
                    .limit(pageSize);

                const snapshot = await nextQuery.get();
                
                snapshot.forEach((doc) => {
                    notifications.push({ id: doc.id, ...doc.data() });
                });

                // Update last visible
                if (snapshot.docs.length > 0) {
                    lastVisible = snapshot.docs[snapshot.docs.length - 1];
                } else {
                    document.getElementById('loadMoreContainer').classList.add('hidden');
                }

                updateNotificationsUI();

            } catch (error) {
                console.error('Error loading more notifications:', error);
                showToast('Error loading more notifications', 'error');
            } finally {
                loadMoreBtn.disabled = false;
                loadMoreBtn.innerHTML = '<i class="fas fa-redo mr-2"></i>Load More Notifications';
            }
        }

        function updateNotificationsUI() {
            const container = document.getElementById('notificationsList');
            const emptyState = document.getElementById('emptyState');
            
            let filteredNotifications = notifications.filter(notification => {
                if (currentFilter === 'all') return true;
                if (currentFilter === 'unread') return !notification.read;
                return notification.type === currentFilter;
            });

            if (filteredNotifications.length === 0) {
                container.classList.add('hidden');
                emptyState.classList.remove('hidden');
                return;
            }

            container.classList.remove('hidden');
            emptyState.classList.add('hidden');

            container.innerHTML = filteredNotifications.map(notification => `
                <div class="notification-card p-4 rounded-lg border-l-4 ${notification.read ? 'notification-read' : 'notification-unread'} type-${notification.type} cursor-pointer" 
                     onclick="markAsRead('${notification.id}')">
                    <div class="flex items-start space-x-4">
                        <div class="flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${
                            notification.type === 'earning' ? 'bg-green-100 text-green-600' :
                            notification.type === 'withdrawal' ? 'bg-yellow-100 text-yellow-600' :
                            notification.type === 'commission' ? 'bg-purple-100 text-purple-600' :
                            notification.type === 'package' ? 'bg-orange-100 text-orange-600' :
                            'bg-gray-100 text-gray-600'
                        }">
                            <i class="fas ${
                                notification.type === 'earning' ? 'fa-money-bill-wave' :
                                notification.type === 'withdrawal' ? 'fa-wallet' :
                                notification.type === 'commission' ? 'fa-hand-holding-usd' :
                                notification.type === 'package' ? 'fa-crown' :
                                'fa-info-circle'
                            }"></i>
                        </div>
                        
                        <div class="flex-1 min-w-0">
                            <div class="flex items-start justify-between">
                                <div>
                                    <h4 class="font-semibold text-gray-900">${notification.title}</h4>
                                    <p class="text-sm text-gray-600 mt-1">${notification.message}</p>
                                    <p class="text-xs text-gray-500 mt-2">
                                        <i class="far fa-clock mr-1"></i>
                                        ${formatTimeAgo(notification.createdAt?.toDate())}
                                    </p>
                                </div>
                                
                                <div class="flex items-center space-x-2">
                                    ${!notification.read ? `
                                        <span class="w-2 h-2 bg-blue-500 rounded-full"></span>
                                    ` : ''}
                                    <button onclick="event.stopPropagation(); deleteNotification('${notification.id}')" 
                                            class="p-1 text-gray-400 hover:text-red-500 transition-colors">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                            
                            ${notification.actionUrl ? `
                                <div class="mt-3">
                                    <a href="${notification.actionUrl}" 
                                       class="inline-flex items-center text-sm text-blue-600 hover:text-blue-700 font-semibold">
                                        View Details <i class="fas fa-arrow-right ml-1 text-xs"></i>
                                    </a>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function formatTimeAgo(date) {
            if (!date) return 'Recently';
            
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) return 'Just now';
            if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} minutes ago`;
            if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} hours ago`;
            if (diffInSeconds < 2592000) return `${Math.floor(diffInSeconds / 86400)} days ago`;
            
            return date.toLocaleDateString('en-IN');
        }

        async function markAsRead(notificationId) {
            try {
                await db.collection('notifications').doc(notificationId).update({
                    read: true,
                    readAt: new Date()
                });
                
                // Update local state
                const notification = notifications.find(n => n.id === notificationId);
                if (notification) {
                    notification.read = true;
                }
                
                updateUnreadCount();
            } catch (error) {
                console.error('Error marking notification as read:', error);
            }
        }

        async function markAllAsRead() {
            const unreadNotifications = notifications.filter(n => !n.read);
            
            if (unreadNotifications.length === 0) {
                showToast('All notifications are already read', 'info');
                return;
            }

            const batch = db.batch();
            unreadNotifications.forEach(notification => {
                const notificationRef = db.collection('notifications').doc(notification.id);
                batch.update(notificationRef, {
                    read: true,
                    readAt: new Date()
                });
            });

            try {
                await batch.commit();
                showToast('All notifications marked as read', 'success');
                
                // Update local state
                notifications.forEach(notification => {
                    notification.read = true;
                });
                
                updateUnreadCount();
                updateNotificationsUI();
            } catch (error) {
                console.error('Error marking all as read:', error);
                showToast('Error marking notifications as read', 'error');
            }
        }

        async function deleteNotification(notificationId) {
            if (!confirm('Are you sure you want to delete this notification?')) return;

            try {
                await db.collection('notifications').doc(notificationId).delete();
                
                // Remove from local array
                notifications = notifications.filter(n => n.id !== notificationId);
                
                updateNotificationsUI();
                updateUnreadCount();
                showToast('Notification deleted', 'success');
            } catch (error) {
                console.error('Error deleting notification:', error);
                showToast('Error deleting notification', 'error');
            }
        }

        async function clearAllNotifications() {
            if (notifications.length === 0) {
                showToast('No notifications to clear', 'info');
                return;
            }

            if (!confirm('Are you sure you want to clear all notifications? This action cannot be undone.')) return;

            const batch = db.batch();
            notifications.forEach(notification => {
                const notificationRef = db.collection('notifications').doc(notification.id);
                batch.delete(notificationRef);
            });

            try {
                await batch.commit();
                notifications = [];
                updateNotificationsUI();
                updateUnreadCount();
                showToast('All notifications cleared', 'success');
            } catch (error) {
                console.error('Error clearing notifications:', error);
                showToast('Error clearing notifications', 'error');
            }
        }

        function updateUnreadCount() {
            const unreadCount = notifications.filter(n => !n.read).length;
            document.getElementById('unreadCount').textContent = unreadCount;
            
            // Update badge in header
            const badge = document.getElementById('notificationBadge');
            if (unreadCount > 0) {
                badge.classList.remove('hidden');
                badge.textContent = unreadCount > 9 ? '9+' : unreadCount;
            } else {
                badge.classList.add('hidden');
            }
        }

        function loadNotificationSettings(userId) {
            db.collection('notification_settings').doc(userId).onSnapshot((doc) => {
                if (doc.exists) {
                    const settings = doc.data();
                    document.getElementById('earningNotifications').checked = settings.earningNotifications !== false;
                    document.getElementById('withdrawalNotifications').checked = settings.withdrawalNotifications !== false;
                    document.getElementById('teamNotifications').checked = settings.teamNotifications !== false;
                    document.getElementById('packageNotifications').checked = settings.packageNotifications !== false;
                    document.getElementById('systemNotifications').checked = settings.systemNotifications !== false;
                    document.getElementById('emailNotifications').checked = settings.emailNotifications || false;
                }
            });
        }

        async function saveNotificationSettings() {
            const settings = {
                earningNotifications: document.getElementById('earningNotifications').checked,
                withdrawalNotifications: document.getElementById('withdrawalNotifications').checked,
                teamNotifications: document.getElementById('teamNotifications').checked,
                packageNotifications: document.getElementById('packageNotifications').checked,
                systemNotifications: document.getElementById('systemNotifications').checked,
                emailNotifications: document.getElementById('emailNotifications').checked,
                updatedAt: new Date()
            };

            try {
                await db.collection('notification_settings').doc(currentUser.uid).set(settings, { merge: true });
                showToast('Notification settings saved successfully', 'success');
            } catch (error) {
                console.error('Error saving notification settings:', error);
                showToast('Error saving settings', 'error');
            }
        }

        function updateUserUI(userData) {
            document.getElementById('userName').textContent = userData.name || 'User';
            document.getElementById('headerUserName').textContent = userData.name || 'User';
            document.getElementById('userRank').textContent = userData.rank || 'Affiliate';
            document.getElementById('userBalance').textContent = userData.balance || 0;

            if (userData.profilePic) {
                document.getElementById('userProfilePic').src = userData.profilePic;
                document.getElementById('headerProfilePic').src = userData.profilePic;
            }
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg text-white font-semibold z-50 ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 'bg-blue-500'
            }`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 5000);
        }
    </script>
</body>
  </html>
