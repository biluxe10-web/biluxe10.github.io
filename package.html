<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Biluxe10 | Choose Your Success Pack</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <style>
    body {
      font-family: Poppins, sans-serif;
      background: #0b0b0b;
      color: white;
      text-align: center;
      padding: 40px;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 40px;
    }
    .card {
      background: #151515;
      border-radius: 15px;
      width: 240px;
      padding: 20px;
      cursor: pointer;
      transition: 0.3s;
    }
    .card:hover {
      background: #1e1e1e;
      transform: scale(1.05);
    }
    img {
      width: 100%;
      border-radius: 10px;
      height: 130px;
      object-fit: cover;
    }
    #coupon {
      margin-top: 20px;
      padding: 10px;
      border-radius: 8px;
      border: none;
      width: 220px;
      outline: none;
    }
  </style>
</head>
<body>
  <h2>Biluxe10 Packages üíº</h2>
  <p>Select your success pack and start your journey üöÄ</p>

  <input id="coupon" placeholder="Enter coupon code (if any)" />
  <div class="container">

    <div class="card" onclick="selectPackage('Starter Success Pack', 999)">
      <img src="file_00000000049461f7920d19bc75bf27d7.png" alt="Starter Pack" />
      <h3>Starter Success Pack</h3>
      <p>‚Çπ999</p>
    </div>

    <div class="card" onclick="selectPackage('Advance Success Pack', 2499)">
      <img src="file_00000000ed7861f7940aaa12396a8cf7.png" alt="Advance Pack" />
      <h3>Advance Success Pack</h3>
      <p>‚Çπ2499</p>
    </div>

    <div class="card" onclick="selectPackage('Digital Empire System', 3499)">
      <img src="file_0000000086e4622fb63ce9f3956bbcb1.png" alt="Digital Empire System" />
      <h3>Digital Empire System</h3>
      <p>‚Çπ3499</p>
    </div>

    <div class="card" onclick="selectPackage('Editing Mastery', 5999)">
      <img src="file_00000000b8d861f4930644f5a6d8054d.png" alt="Editing Mastery" />
      <h3>Editing Mastery</h3>
      <p>‚Çπ4999</p>
    </div>

    <div class="card" onclick="selectPackage('Ultimate Dropshipping System', 9999)">
      <img src="file_00000000832461faafd5a3755e5fae00.png" alt="Dropshipping System" />
      <h3>Ultimate Dropshipping System</h3>
      <p>‚Çπ9999</p>
    </div>

    <div class="card" onclick="selectPackage('Crypto Trading Mastery', 15999)">
      <img src="file_00000000bf04620a8d4a21838cb258f3.png" alt="Crypto Trading Mastery" />
      <h3>Crypto Trading Mastery</h3>
      <p>‚Çπ15999</p>
    </div>

    <div class="card" onclick="selectPackage('Future AI System', 24999)">
      <img src="file_000000008bbc61fabe3b760d241a3ce4.png" alt="Future AI System" />
      <h3>Future AI System</h3>
      <p>‚Çπ23999</p>
    </div>

  </div>

  <p id="msg" style="margin-top:30px; color:#00ff99;"></p>

  <script>
    const SUPABASE_URL = "https://cisbvzecomyueslqkmbd.supabase.co";
    const SUPABASE_KEY =
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpc2J2emVjb215dWVzbHFrbWJkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MDMwNTIsImV4cCI6MjA3NTQ3OTA1Mn0.hUNwgoIt-hgh21a1WNqsGkC2QC6mpwAcio5ek86kAfc";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    async function selectPackage(name, amount) {
      document.getElementById("msg").innerText = "Processing your request...";
      const coupon = document.getElementById("coupon").value.trim();
      let finalAmount = amount;
      let offerType = "paid";

      if (coupon === "BILUXE10FREE") {
        finalAmount = 0;
        offerType = "free";
      }

      const { data: { user } } = await supabase.auth.getUser();
      if (!user) {
        document.getElementById("msg").innerText = "‚ö†Ô∏è Please login again!";
        return (window.location.href = "auth.html");
      }

      const userId = "BILUXE10" + Math.floor(1000 + Math.random() * 9000);

      const { error } = await supabase.from("packages").insert([
        {
          email: user.email,
          package_name: name,
          package_amount: finalAmount,
          offer_type: offerType,
          coupon_code: coupon || null,
          status: "pending",
          unique_id: userId,
        },
      ]);

      if (error) {
        document.getElementById("msg").innerText = "‚ö†Ô∏è " + error.message;
      } else {
        document.getElementById("msg").innerText =
          offerType === "free"
            ? "üéâ Free seat applied! Admin approval pending."
            : "‚úÖ Package selected! Wait for admin approval.";
      }
    }
  </script>
</body>
</html>
